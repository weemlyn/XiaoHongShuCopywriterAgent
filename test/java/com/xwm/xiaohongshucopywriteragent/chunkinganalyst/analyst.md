# LangChain4j 1.0.0 åˆ†å—ç­–ç•¥å¯¹æ¯”å·¥å…· - å­¦ä¹ åˆ†ææ•™æ¡ˆ

## ğŸ“š é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº LangChain4j 1.0.0 çš„æ–‡æ¡£åˆ†å—ç­–ç•¥å¯¹æ¯”å·¥å…·ï¼Œç”¨äºåˆ†æå’Œæ¯”è¾ƒä¸åŒçš„æ–‡æœ¬åˆ†å—ç®—æ³•åœ¨ä¸­æ–‡æ–‡æ¡£å¤„ç†ä¸­çš„è¡¨ç°ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

1. ç†è§£æ–‡æ¡£åˆ†å—çš„åŸºæœ¬æ¦‚å¿µå’Œé‡è¦æ€§
2. æŒæ¡ LangChain4j 1.0.0 çš„åˆ†å—å™¨ API ä½¿ç”¨
3. å­¦ä¼šè®¾è®¡å’Œå®ç°åˆ†å—ç­–ç•¥å¯¹æ¯”æ¡†æ¶
4. æŒæ¡æ–‡æœ¬å¤„ç†çš„è´¨é‡è¯„ä¼°æ–¹æ³•

## ğŸ“– æ ¸å¿ƒæ¦‚å¿µè§£æ

### 1. æ–‡æ¡£åˆ†å— (Document Chunking)

**å®šä¹‰**ï¼šå°†é•¿æ–‡æ¡£åˆ†å‰²æˆè¾ƒå°çš„ã€è¯­ä¹‰å®Œæ•´çš„æ–‡æœ¬ç‰‡æ®µ

**é‡è¦æ€§**ï¼š
- æé«˜æ£€ç´¢æ•ˆç‡
- å¢å¼ºè¯­ä¹‰ç†è§£
- ä¼˜åŒ–å‘é‡åµŒå…¥è´¨é‡
- æ”¹å–„å¤§è¯­è¨€æ¨¡å‹å¤„ç†æ•ˆæœ

### 2. åˆ†å—ç­–ç•¥ç±»å‹

```java
// ä¸‰ç§ä¸»è¦åˆ†å—ç­–ç•¥
- é€’å½’å­—ç¬¦åˆ†å— (RecursiveSplitter)
- æŒ‰æ®µè½åˆ†å— (ParagraphSplitter)  
- æŒ‰å¥å­åˆ†å— (SentenceSplitter)
```

## ğŸ”§ ä»£ç æ¶æ„åˆ†æ

### 1. æ•°æ®æ¨¡å‹å±‚

#### `TestDataGenerator` - æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨

**åŠŸèƒ½**ï¼šåˆ›å»ºå¤šæ ·åŒ–çš„æµ‹è¯•æ–‡æ¡£

**è®¾è®¡æ¨¡å¼**ï¼šå·¥å‚æ¨¡å¼ + å»ºé€ è€…æ¨¡å¼

```java
// æ ¸å¿ƒæ–¹æ³•è§£æ
public static List<Document> createTestDocuments() {
    return Arrays.asList(
        createTechnicalDocument(),    // æŠ€æœ¯æ–‡æ¡£
        createNewsArticle(),          // æ–°é—»æ–‡ç« 
        createAcademicPaper(),        // å­¦æœ¯è®ºæ–‡
        createCodeDocument(),         // ä»£ç æ–‡æ¡£
        createMixedContentDocument()  // æ··åˆå†…å®¹æ–‡æ¡£
    );
}
```

**å­¦ä¹ è¦ç‚¹**ï¼š
- `Document.from(content, metadata)` åˆ›å»ºæ–‡æ¡£å¯¹è±¡
- `Metadata.metadata("key", "value").put("key2", "value2")` å…ƒæ•°æ®æ„å»º
- å¤šæ–‡æœ¬ç±»å‹è¦†ç›–ç¡®ä¿æµ‹è¯•å…¨é¢æ€§

#### `Document` ä¸ `TextSegment` çš„åŒºåˆ«

```java
// Document - åŸå§‹æ–‡æ¡£
Document doc = Document.from("å†…å®¹", metadata);

// TextSegment - åˆ†å—åçš„æ–‡æœ¬ç‰‡æ®µ  
List<TextSegment> chunks = splitter.split(doc);
```

### 2. åˆ†å—ç­–ç•¥å±‚

#### `SplitterFactory` - åˆ†å—å™¨å·¥å‚

**åŠŸèƒ½**ï¼šåˆ›å»ºå’Œç®¡ç†ä¸åŒçš„åˆ†å—ç­–ç•¥

**è®¾è®¡æ¨¡å¼**ï¼šå·¥å‚æ¨¡å¼ + é…ç½®æ¨¡å¼

```java
// åˆ†å—å™¨é…ç½®åŒ…è£…ç±»
public static class SplitterConfig {
    private final String name;           // ç­–ç•¥åç§°
    private final DocumentSplitter splitter; // åˆ†å—å™¨å®ä¾‹
}
```

**åˆ†å—å™¨å‚æ•°è§£æ**ï¼š
```java
// é€’å½’åˆ†å—å™¨ï¼šDocumentSplitters.recursive(maxSize, overlap)
DocumentSplitters.recursive(500, 50)  // æœ€å¤§500å­—ç¬¦ï¼Œé‡å 50å­—ç¬¦

// æ®µè½åˆ†å—å™¨ï¼šnew DocumentByParagraphSplitter(maxSize, overlap)  
new DocumentByParagraphSplitter(300, 30)

// å¥å­åˆ†å—å™¨ï¼šnew DocumentBySentenceSplitter(maxSize, overlap)
new DocumentBySentenceSplitter(100, 10)
```

### 3. åˆ†æè¯„ä¼°å±‚

#### `ChunkingMetrics` - åˆ†å—æŒ‡æ ‡è®¡ç®—

**åŠŸèƒ½**ï¼šè®¡ç®—åˆ†å—è´¨é‡çš„å„ç§ç»Ÿè®¡æŒ‡æ ‡

**æ ¸å¿ƒæŒ‡æ ‡**ï¼š
- `totalChunks` - æ€»åˆ†å—æ•°
- `averageChunkSize` - å¹³å‡åˆ†å—å¤§å°
- `chunkSizeStdDev` - åˆ†å—å¤§å°æ ‡å‡†å·®
- `min/maxChunkSize` - æœ€å°/æœ€å¤§åˆ†å—å¤§å°

**ç»Ÿè®¡è®¡ç®—å®ç°**ï¼š
```java
// æ‰‹åŠ¨å®ç°ç»Ÿè®¡è®¡ç®—ï¼ˆé¿å…å¤–éƒ¨ä¾èµ–ï¼‰
private double calculateMean(double[] values) {
    double sum = 0;
    for (double value : values) {
        sum += value;
    }
    return sum / values.length;
}
```

#### `ChunkingResult` - åˆ†å—ç»“æœå°è£…

**åŠŸèƒ½**ï¼šå°è£…å•æ¬¡åˆ†å—å®éªŒçš„æ‰€æœ‰ç»“æœ

**åŒ…å«ä¿¡æ¯**ï¼š
- ç­–ç•¥åç§°å’Œåˆ†å—å™¨å®ä¾‹
- åˆ†å—ç»“æœåˆ—è¡¨
- å¤„ç†æ—¶é—´
- è´¨é‡æŒ‡æ ‡

### 4. å¯¹æ¯”åˆ†æå±‚

#### `ChunkingComparator` - åˆ†å—å¯¹æ¯”å™¨

**åŠŸèƒ½**ï¼šæ‰§è¡Œå¤šç­–ç•¥å¯¹æ¯”å¹¶ç”Ÿæˆåˆ†ææŠ¥å‘Š

**æ ¸å¿ƒç®—æ³•**ï¼š
```java
// æ•ˆç‡è¯„åˆ†ç®—æ³•
private double calculateEfficiencyScore(ChunkingResult result) {
    double chunkCountPenalty = Math.abs(åˆ†å—æ•° - 35) / 35.0;  // ç›®æ ‡35ä¸ªåˆ†å—
    double sizeStdPenalty = æ ‡å‡†å·® / 100.0;                   // ç¨³å®šæ€§æƒ©ç½š
    double timePenalty = å¤„ç†æ—¶é—´ms / 1000.0;                 // æ€§èƒ½æƒ©ç½š
    
    return chunkCountPenalty * 0.5 + sizeStdPenalty * 0.3 + timePenalty * 0.2;
}
```

**æƒé‡åˆ†é…**ï¼š
- åˆ†å—æ•°é‡ï¼š50% ï¼ˆæœ€é‡è¦ï¼‰
- å¤§å°å‡åŒ€æ€§ï¼š30% ï¼ˆè´¨é‡ï¼‰
- å¤„ç†æ—¶é—´ï¼š20% ï¼ˆæ€§èƒ½ï¼‰

## ğŸ“ å…³é”®æŠ€æœ¯ç‚¹

### 1. LangChain4j 1.0.0 API ä½¿ç”¨

```java
// æ–‡æ¡£åˆ›å»º
Document document = Document.from(content, metadata);

// åˆ†å—æ‰§è¡Œ  
List<TextSegment> chunks = splitter.split(document);

// å…ƒæ•°æ®æ“ä½œ
Metadata metadata = Metadata.metadata("type", "technical")
    .put("topic", "microservices");
```

### 2. æµå¼å¤„ç†ä¸å‡½æ•°å¼ç¼–ç¨‹

```java
// æµå¼å¤„ç†åˆ†å—ç»“æœ
double[] sizes = chunks.stream()
    .mapToDouble(chunk -> chunk.text().length())
    .toArray();

// ç»“æœæ’åºå’Œç­›é€‰
comparisonResults.stream()
    .sorted(Comparator.comparingDouble(this::calculateEfficiencyScore))
    .collect(Collectors.toList());
```

### 3. æ—¶é—´æ€§èƒ½æµ‹é‡

```java
Instant start = Instant.now();
// æ‰§è¡Œåˆ†å—æ“ä½œ
Duration processingTime = Duration.between(start, Instant.now());
```

## ğŸ“Š è¯„ä¼°æŒ‡æ ‡ä½“ç³»

### 1. æ•°é‡æŒ‡æ ‡
- **æ€»åˆ†å—æ•°**ï¼šåæ˜ åˆ†ç²’åº¦
- **ç†æƒ³èŒƒå›´**ï¼š20-50ä¸ªåˆ†å—ï¼ˆé’ˆå¯¹æµ‹è¯•æ•°æ®é›†ï¼‰

### 2. è´¨é‡æŒ‡æ ‡
- **å¹³å‡åˆ†å—å¤§å°**ï¼šåæ˜ ä¿¡æ¯å¯†åº¦
- **å¤§å°æ ‡å‡†å·®**ï¼šåæ˜ åˆ†å—å‡åŒ€æ€§
- **æœ€å°/æœ€å¤§åˆ†å—**ï¼šåæ˜ æç«¯æƒ…å†µ

### 3. æ€§èƒ½æŒ‡æ ‡
- **å¤„ç†æ—¶é—´**ï¼šåæ˜ ç®—æ³•æ•ˆç‡

## ğŸ” å®éªŒè®¾è®¡æ€è·¯

### 1. æµ‹è¯•æ•°æ®å¤šæ ·æ€§
- æŠ€æœ¯æ–‡æ¡£ã€æ–°é—»ã€å­¦æœ¯è®ºæ–‡ã€ä»£ç ã€æ··åˆå†…å®¹
- è¦†ç›–ä¸åŒæ–‡ä½“å’Œç»“æ„ç‰¹ç‚¹

### 2. å‚æ•°ç»„åˆæµ‹è¯•
- å¤šç§åˆ†å—å¤§å°é…ç½®
- ä¸åŒé‡å åº¦è®¾ç½®
- ä¸‰ç§åˆ†å—ç®—æ³•å¯¹æ¯”

### 3. ç»¼åˆè¯„ä»·æ–¹æ³•
- å¤šç»´åº¦æŒ‡æ ‡åŠ æƒ
- è‡ªåŠ¨åŒ–æ’åæ¨è
- è¯¦ç»†ç»“æœå¯è§†åŒ–

## ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯

### 1. RAG ç³»ç»Ÿä¼˜åŒ–
- ä¸ºæ£€ç´¢å¢å¼ºç”Ÿæˆé€‰æ‹©æœ€ä½³åˆ†å—ç­–ç•¥
- å¹³è¡¡æ£€ç´¢ç²¾åº¦å’Œè®¡ç®—æˆæœ¬

### 2. æ–‡æœ¬å¤„ç†ç®¡é“è®¾è®¡
- æ ¹æ®æ–‡æ¡£ç±»å‹é€‰æ‹©åˆé€‚çš„åˆ†å—æ–¹æ³•
- å‚æ•°è°ƒä¼˜å’Œæ€§èƒ½ä¼˜åŒ–

### 3. ç®—æ³•å¯¹æ¯”ç ”ç©¶
- æ–°åˆ†å—ç®—æ³•çš„åŸºå‡†æµ‹è¯•
- ä¸åŒè¯­è¨€å’Œé¢†åŸŸçš„é€‚åº”æ€§åˆ†æ

## ğŸš€ æ‰©å±•å­¦ä¹ å»ºè®®

### 1. æ·±å…¥ç ”ç©¶æ–¹å‘
- å°è¯•æ›´å¤šåˆ†å—ç®—æ³•ï¼ˆè¯­ä¹‰åˆ†å—ã€ä¸»é¢˜åˆ†å—ï¼‰
- æ·»åŠ ä¸­æ–‡ç‰¹å®šçš„åˆ†å—é€»è¾‘
- é›†æˆå‘é‡ç›¸ä¼¼åº¦è¯„ä¼°

### 2. å·¥ç¨‹ä¼˜åŒ–æ–¹å‘
- æ·»åŠ å¹¶è¡Œå¤„ç†æ”¯æŒ
- å®ç°å¢é‡åˆ†å—å’Œç¼“å­˜
- æ·»åŠ å®æ—¶ç›‘æ§å’Œè°ƒä¼˜

### 3. ä¸šåŠ¡åº”ç”¨æ–¹å‘
- é’ˆå¯¹ç‰¹å®šé¢†åŸŸå®šåˆ¶åˆ†å—ç­–ç•¥
- é›†æˆåˆ°å®é™…çš„æ–‡æ¡£å¤„ç†æµç¨‹
- æ„å»ºåˆ†å—ç­–ç•¥æ¨èç³»ç»Ÿ

è¿™ä¸ªæ•™æ¡ˆæ¶µç›–äº†ä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ï¼Œå¸®åŠ©æ‚¨å…¨é¢æŒæ¡æ–‡æ¡£åˆ†å—æŠ€æœ¯çš„åŸç†ã€å®ç°å’Œåº”ç”¨ã€‚